<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FixYourSleep | Master Your Rest</title>
    <style>
        /* DESIGN - Optimized for Dark Mode */
        :root {
            --bg-color: #0f172a; 
            --card-bg: #1e293b;
            --text-main: #f1f5f9;
            --text-muted: #94a3b8;
            --accent: #38bdf8; 
            --accent-hover: #0ea5e9;
            --font-main: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: var(--font-main);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            min-height: 100vh;
            transition: all 0.5s ease; /* Smooth transition for Easter Egg */
        }

        .container {
            max-width: 600px;
            width: 100%;
        }

        /* The LOGO is the Easter Egg trigger */
        h1 { 
            text-align: center; 
            margin-bottom: 5px; 
            color: var(--accent); 
            cursor: pointer; 
            user-select: none;
        }
        
        .subtitle { text-align: center; color: var(--text-muted); margin-bottom: 40px; font-size: 0.9em; }

        .card {
            background-color: var(--card-bg);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            margin-bottom: 30px;
            transition: all 0.5s ease;
        }

        label { display: block; margin-bottom: 10px; color: var(--text-muted); }
        
        input[type="time"] {
            width: 100%;
            padding: 15px;
            background: #0f172a;
            border: 1px solid #334155;
            color: white;
            border-radius: 8px;
            font-size: 1.2em;
            margin-bottom: 20px;
            box-sizing: border-box; 
        }

        button {
            width: 100%;
            padding: 15px;
            background-color: var(--accent);
            color: #0f172a;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            font-size: 1.1em;
            cursor: pointer;
            transition: background 0.2s;
        }

        button:hover { background-color: var(--accent-hover); }

        .result-box {
            margin-top: 20px;
            padding: 15px;
            background: rgba(56, 189, 248, 0.1);
            border-radius: 8px;
            text-align: center;
            display: none; 
        }

        .times-list {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--accent);
            margin: 10px 0;
        }

        /* DIAGNOSTICS STYLES */
        .diag-step { display: none; } 
        .diag-step.active { display: block; animation: fadeIn 0.5s; }

        .option-btn {
            background: #334155;
            color: white;
            margin-bottom: 10px;
            text-align: left;
        }
        .option-btn:hover { background: #475569; }

        /* AFFILIATE BOXES */
        .affiliate-box {
            border: 1px solid var(--accent);
            padding: 15px;
            margin-top: 15px;
            border-radius: 8px;
            background: rgba(56, 189, 248, 0.05);
        }
        
        .affiliate-title { color: var(--accent); font-weight: bold; margin-bottom: 5px; display: block; }
        .affiliate-link { text-decoration: none; color: white; display: block; margin-top: 10px; font-weight: bold; text-decoration: underline;}

        .level-tabs {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            border-bottom: 1px solid #334155;
            padding-bottom: 10px;
        }
        .tab { 
            cursor: pointer; 
            color: var(--text-muted); 
            font-size: 0.9em; 
            flex: 1; 
            text-align: center;
        }
        .tab.active { color: var(--accent); border-bottom: 2px solid var(--accent); }
        
        .content-section { display: none; margin-top: 15px; font-size: 0.9em; line-height: 1.6; }
        .content-section.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* MATRIX MODE STYLES (EASTER EGG) */
        body.matrix-mode {
            background-color: #000 !important;
            font-family: 'Courier New', Courier, monospace !important;
        }
        body.matrix-mode * {
            color: #00ff00 !important;
            border-color: #00ff00 !important;
        }
        body.matrix-mode .card {
            background-color: #000 !important;
            border: 1px solid #00ff00;
            box-shadow: none;
        }
        body.matrix-mode button {
            background-color: #003300 !important;
            color: #00ff00 !important;
        }
        body.matrix-mode .affiliate-box {
            background: transparent !important;
        }

    </style>
</head>
<body>

<div class="container">
    <h1 id="mainTitle" onclick="triggerEasterEgg()">FixYourSleep<span style="color:white">.now</span></h1>
    <div class="subtitle">Don't be a zombie. Fix your routine.</div>

    <div class="card">
        <h3>üí§ When do you need to wake up?</h3>
        <input type="time" id="wakeTime">
        <button onclick="calculateSleep()">Calculate Bedtime</button>
        
        <div id="calcResult" class="result-box">
            <div>To wake up fresh, go to bed at:</div>
            <div class="times-list" id="sleepTimes"></div>
            <div style="font-size: 0.8em; color: var(--text-muted)">Based on 90-min sleep cycles (+15 min to fall asleep).</div>
        </div>
    </div>

    <div class="card" id="diagnosticSection">
        <h3>üîß Sleep Diagnostics</h3>
        <p style="color: var(--text-muted); font-size: 0.9em;">Answer 2 questions to get your personal blueprint.</p>
        <hr style="border: 0; border-top: 1px solid #334155; margin: 20px 0;">

        <div id="step1" class="diag-step active">
            <label>What is your biggest struggle?</label>
            <button class="option-btn" onclick="nextStep('hot')">ü•µ I'm too hot / Sweating</button>
            <button class="option-btn" onclick="nextStep('cold')">ü•∂ I'm freezing / Cold feet</button>
            <button class="option-btn" onclick="nextStep('pain')">ü§ï Neck / Back pain</button>
            <button class="option-btn" onclick="nextStep('noise')">üîä Noise / Light sensitivity</button>
            <button class="option-btn" onclick="nextStep('stress')">üß† Overthinking / Stress</button>
        </div>

        <div id="step2" class="diag-step">
            <label>Select your biological sex (for hormonal context):</label>
            <button class="option-btn" onclick="showResult('male')">Male</button>
            <button class="option-btn" onclick="showResult('female')">Female</button>
        </div>

        <div id="finalResult" class="diag-step">
            <h2 style="color: var(--accent); margin-top:0;">Your Blueprint:</h2>
            
            <div class="level-tabs">
                <div class="tab active" onclick="switchTab('quick')">‚ö° Quick Fix</div>
                <div class="tab" onclick="switchTab('science')">üß¨ Science</div>
                <div class="tab" onclick="switchTab('blueprint')">üìê Full Plan</div>
            </div>

            <div id="content-quick" class="content-section active">
                <p id="quickTipText">...</p>
                
                <div class="affiliate-box">
                    <span class="affiliate-title">üí° Recommended Tool:</span>
                    <span id="productName">...</span>
                    <a href="#" id="productLink" class="affiliate-link" target="_blank">Check Price (Amazon) &rarr;</a>
                </div>
            </div>

            <div id="content-science" class="content-section">
                <p id="scienceText">...</p>
            </div>

            <div id="content-blueprint" class="content-section">
                <p>Your optimized evening routine:</p>
                <ul id="blueprintList" style="padding-left: 20px;"></ul>
            </div>

            <button onclick="resetDiag()" style="margin-top: 20px; background: #334155;">Start Over</button>
        </div>
    </div>

    <div style="text-align: center; margin-top: 50px; font-size: 0.8em; color: #334155;">
        &copy; 2026 FixYourSleep. Not medical advice.
    </div>
</div>

<script>
    /* ========================================
    LOGIC PART
    ========================================
    */

    // --- EASTER EGG LOGIC (MATRIX MODE) ---
    let eggClicks = 0;
    function triggerEasterEgg() {
        eggClicks++;
        if (eggClicks === 7) { // 7 CLICKS TO ACTIVATE
            document.body.classList.toggle('matrix-mode');
            
            // Change title text
            const title = document.getElementById('mainTitle');
            if(document.body.classList.contains('matrix-mode')) {
                title.innerText = "WAKE UP NEO, YOU HAVE TO DEFEAT PUPI";
                alert("üêá Follow the white rabbit.");
            } else {
                title.innerHTML = 'FixYourSleep<span style="color:white">.now</span>';
            }
            eggClicks = 0; // Reset
        }
    }
    // --------------------------------------

    // 1. SLEEP CALCULATOR
    function calculateSleep() {
        const input = document.getElementById('wakeTime').value;
        if (!input) return;

        const [hours, minutes] = input.split(':').map(Number);
        const wakeDate = new Date();
        wakeDate.setHours(hours, minutes, 0);

        const now = new Date();
        if (wakeDate < now) {
            wakeDate.setDate(wakeDate.getDate() + 1);
        }

        // 6 cycles (9h), 5 cycles (7.5h), 4 cycles (6h) + 15 min fall asleep time
        let time6 = new Date(wakeDate.getTime() - (9 * 60 * 60 * 1000) - (15 * 60 * 1000));
        let time5 = new Date(wakeDate.getTime() - (7.5 * 60 * 60 * 1000) - (15 * 60 * 1000));
        let time4 = new Date(wakeDate.getTime() - (6 * 60 * 60 * 1000) - (15 * 60 * 1000));

        const format = (d) => d.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});

        let resultHTML = "";
        resultHTML += `<div>${format(time6)} <span style="font-size:0.6em; color:#94a3b8">(9h - Best)</span></div>`;
        resultHTML += `<div>${format(time5)} <span style="font-size:0.6em; color:#94a3b8">(7.5h - Good)</span></div>`;
        resultHTML += `<div>${format(time4)} <span style="font-size:0.6em; color:#94a3b8">(6h - Minimum)</span></div>`;

        document.getElementById('sleepTimes').innerHTML = resultHTML;
        document.getElementById('calcResult').style.display = 'block';
    }

    // 2. DIAGNOSTICS LOGIC
    let selectedIssue = '';
    let selectedGender = '';

    function nextStep(issue) {
        selectedIssue = issue;
        document.getElementById('step1').classList.remove('active');
        document.getElementById('step2').classList.add('active');
    }

    function showResult(gender) {
        selectedGender = gender;
        document.getElementById('step2').classList.remove('active');
        document.getElementById('finalResult').classList.add('active');
        
        generateContent();
    }

    function resetDiag() {
        document.getElementById('finalResult').classList.remove('active');
        document.getElementById('step1').classList.add('active');
        switchTab('quick');
        eggClicks = 0; // Reset egg counter just in case
    }

    function switchTab(tabName) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.content-section').forEach(c => c.classList.remove('active'));

        event.target.classList.add('active');
        document.getElementById('content-' + tabName).classList.add('active');
    }

    // CONTENT GENERATOR (ENGLISH + AFFILIATE)
    function generateContent() {
        let quickTip = "";
        let science = "";
        let product = "";
        let productUrl = ""; // REPLACE THESE LINKS WITH YOUR AMAZON LINKS
        let blueprint = [];

        // CASE: HOT / SWEATING
        if (selectedIssue === 'hot') {
            quickTip = "Your body needs to drop 2-3¬∞F to initiate sleep. You are currently overheating.";
            science = "Deep sleep (NREM) requires a drop in core body temperature. When you overheat, your body pumps blood to the skin to cool down, keeping your heart rate elevated and blocking deep sleep recovery. This is critical if " + (selectedGender === 'male' ? "you have high testosterone levels." : "you are in the luteal phase of your cycle.");
            product = "Cooling Gel Pillow / Bamboo Sheets";
            productUrl = "https://www.amazon.com/s?k=cooling+pillow"; // UPDATE THIS
            blueprint = [
                "1 Hour before bed: Ventilate room, aim for 65-68¬∞F (19¬∞C).",
                "Shower: Lukewarm water (not cold, as it shocks the body awake).",
                "Clothing: 100% Cotton or nothing. Polyester traps heat.",
                "Gear: Switch to a cooling gel pillow immediately."
            ];
        }
        
        // CASE: COLD
        else if (selectedIssue === 'cold') {
            quickTip = "If your hands or feet are cold, your brain won't receive the 'sleep signal'.";
            science = "The Sleep Paradox: Core body temp must drop, but extremities must be warm (vasodilation) to dump heat from the core. Cold feet constrict blood vessels, trapping heat in the core and preventing sleep onset.";
            product = "Weighted Blanket";
            productUrl = "https://www.amazon.com/s?k=weighted+blanket"; // UPDATE THIS
            blueprint = [
                "Bedtime: Wear socks. It looks goofy, but science says it works.",
                "Drink: Hot herbal tea (Chamomile or Lemon balm).",
                "Gear: Use a Weighted Blanket to increase thermal comfort and reduce cortisol."
            ];
        }

        // CASE: PAIN
        else if (selectedIssue === 'pain') {
            quickTip = "Your pillow is likely fighting your spine alignment.";
            science = "Micro-adjustments due to discomfort prevent your brain from entering deep sleep paralysis. Your muscles remain tense to protect the spine, leading to 'waking up tired'.";
            product = "Ergonomic Memory Foam Pillow";
            productUrl = "https://www.amazon.com/s?k=ergonomic+pillow"; // UPDATE THIS
            blueprint = [
                "Position: Back sleepers need thin pillows. Side sleepers need thick ones to fill the shoulder gap.",
                "Stretch: 2 minutes of neck rolls before bed.",
                "Gear: Ditch the old feather pillow for structured Memory Foam."
            ];
        }

        // CASE: NOISE / LIGHT
        else if (selectedIssue === 'noise') {
            quickTip = "Your hunter-gatherer brain is scanning for threats. You are too alert.";
            science = "Even dim light (like a standby LED) suppresses melatonin production. Sudden noises trigger a cortisol spike, pulling you out of REM sleep instantly.";
            product = "Sleep Mask + Earplugs Kit";
            productUrl = "https://www.amazon.com/s?k=sleep+mask"; // UPDATE THIS
            blueprint = [
                "Blackout: Total darkness is non-negotiable.",
                "Audio: If you can't silence the world, mask it with a 'White Noise' machine or app.",
                "Phone: 'Do Not Disturb' mode ON from 8 PM."
            ];
        }

        // CASE: STRESS / OVERTHINKING
        else {
            quickTip = "Your body is tired, but your brain is in Beta-wave mode (alert).";
            science = "Racing thoughts keep the brain in high-frequency Beta waves. You need to transition to Alpha and Theta waves. Blue light and stress prevent this neurological shift.";
            product = "Blue Light Blocking Glasses";
            productUrl = "https://www.amazon.com/s?k=blue+light+glasses"; // UPDATE THIS
            blueprint = [
                "Brain Dump: Write down tomorrow's tasks on paper to 'offload' them from RAM.",
                "Breathing: 4-7-8 Technique (Inhale 4s, Hold 7s, Exhale 8s).",
                "Gear: Wear Blue Light Glasses 2 hours before bed if you must use screens."
            ];
        }

        // INJECT CONTENT
        document.getElementById('quickTipText').innerText = quickTip;
        document.getElementById('scienceText').innerText = science;
        document.getElementById('productName').innerText = product;
        
        let linkElem = document.getElementById('productLink');
        linkElem.href = productUrl; 
        
        let listHTML = "";
        blueprint.forEach(item => listHTML += `<li>${item}</li>`);
        document.getElementById('blueprintList').innerHTML = listHTML;
    }

</script>

</body>
</html>